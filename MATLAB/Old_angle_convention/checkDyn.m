function [qddot1, qddot2] = checkDyn(t1, t1d, t2, t2d, T2)


c1 = cos(t1);
c2 = cos(t2);
s2 = sin(t2);
c12 = cos(t1 + t2);
T1 = 0;

[Is, ls, ms, g] = getDynParams();
I1 = Is(1);
I2 = Is(2);
l1 = ls(1);
l2 = ls(2);
m1 = ms(1);
m2 = ms(2);

% Solved form used in Simulink
tic
t1dd = (4*I2*T1 - 4*I2*T2 + T1*l2^2*m2 - T2*l2^2*m2 - ...
    c1*g*l1*l2^2*m2^2 - 2*I2*c1*g*l1*m1 - 4*I2*c1*g*l1*m2 - ...
    2*T2*c2*l1*l2*m2 + (l1*l2^3*m2^2*s2*t1d^2)/2 + ...
    (l1*l2^3*m2^2*s2*t2d^2)/2 + 2*I2*l1*l2*m2*s2*t1d^2 + ...
    2*I2*l1*l2*m2*s2*t2d^2 - (c1*g*l1*l2^2*m1*m2)/2 + ...
    c2*l1^2*l2^2*m2^2*s2*t1d^2 + c2*c12*g*l1*l2^2*m2^2 + ...
    l1*l2^3*m2^2*s2*t1d*t2d + 4*I2*l1*l2*m2*s2*t1d*t2d)/ ...
    (- c2^2*l1^2*l2^2*m2^2 + l1^2*l2^2*m2^2 + ...
    4*I2*l1^2*m2 + I1*l2^2*m2 + 4*I1*I2);

t2dd = -(4*I2*T1 - 4*I1*T2 - 4*I2*T2 + T1*l2^2*m2 - 4*T2*l1^2*m2 - ...
    T2*l2^2*m2 - c1*g*l1*l2^2*m2^2 + 2*c12*g*l1^2*l2*m2^2 - ...
    2*I2*c1*g*l1*m1 - 4*I2*c1*g*l1*m2 + 2*I1*c12*g*l2*m2 + ...
    2*T1*c2*l1*l2*m2 - 4*T2*c2*l1*l2*m2 + (l1*l2^3*m2^2*s2*t1d^2)/2 + ...
    2*l1^3*l2*m2^2*s2*t1d^2 + (l1*l2^3*m2^2*s2*t2d^2)/2 + ...
    2*I1*l1*l2*m2*s2*t1d^2 + 2*I2*l1*l2*m2*s2*t1d^2 + ...
    2*I2*l1*l2*m2*s2*t2d^2 - (c1*g*l1*l2^2*m1*m2)/2 + ...
    2*c2*l1^2*l2^2*m2^2*s2*t1d^2 + c2*l1^2*l2^2*m2^2*s2*t2d^2 - ...
    2*c1*c2*g*l1^2*l2*m2^2 + c2*c12*g*l1*l2^2*m2^2 + ...
    l1*l2^3*m2^2*s2*t1d*t2d + 4*I2*l1*l2*m2*s2*t1d*t2d + ...
    2*c2*l1^2*l2^2*m2^2*s2*t1d*t2d - c1*c2*g*l1^2*l2*m1*m2)/(- ...
    c2^2*l1^2*l2^2*m2^2 + l1^2*l2^2*m2^2 + 4*I2*l1^2*m2 + I1*l2^2*m2 + ...
    4*I1*I2);
toc
qddot1 = [t1dd;t2dd];

% Matrix form
tic
M = [I1+I2+m2*(l1^2+0.25*l2^2+l1*l2*cos(t2)), ...
    I2+0.5*m2*(0.5*l2^2+l1*l2*cos(t2)); ...
    I2+0.5*m2*(0.5*l2^2+l1*l2*cos(t2)), ...
    I2+0.25*m2*l2^2];
C = sin(t2)*[-m2*l1*l2*t2d, -0.5*m2*l1*l2*t2d; 0.5*m2*l1*l2*t1d, 0];
G = [0.5*l1*m1*g*cos(t1) + m2*g*(l1*cos(t1)+0.5*l2*cos(t1+t2))
    0.5*m2*g*l2*cos(t1+t2)];

qddot2 = M\(-C*[t1d;t2d] - G + [0;1]*T2);
toc