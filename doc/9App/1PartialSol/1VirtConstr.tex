Recall the vector functions from Section \ref{sec:zerodyn}. Assuming that the phase variable is simply the unactuated coordinate, as is typically the case for underactuated walking robots,
\begin{align*}
	\Phi\left(\theta\right) &= 
	\begin{bmatrix}
	\phi_1\left(\theta\right) & \ldots & \phi_{n-1}\left(\theta\right) & \theta
	\end{bmatrix}^T \\
	\Phi'\left(\theta\right) &=
	\begin{bmatrix}
	\frac{\partial\phi_1\left(\theta\right)}{\partial\theta} & \ldots & \frac{\partial\phi_{n-1}\left(\theta\right)}{\partial\theta} & 1 
	\end{bmatrix}^T \\
	\Phi''\left(\theta\right) &=
	\begin{bmatrix}
	\frac{\partial^2\phi_1\left(\theta\right)}{\partial\theta^2} & \ldots & \frac{\partial^2\phi_{n-1}\left(\theta\right)}{\partial\theta^2} & 0 
	\end{bmatrix}^T
\end{align*}

Now, under BÃ©zier constraints, we can explicitly calculate the virtual constraint and its derivatives:
\begin{subequations}
\begin{align}
	\phi_k\left(\theta\right) &= \sum_{i=0}^{N}\binom{N}{i}
	(1-s)^{N-i} s^i\alpha_i^k \\
	s &= \frac{\theta - \theta_0}{\theta^- - \theta_0}
\end{align}
\end{subequations}
\begin{align}
	(\theta^--\theta_0)\frac{\partial\phi_k}{\partial\theta} &=
	N\left( s^{N-1}\alpha^k_N - (1-s)^{N-1}\alpha^k_0 \right) \\ \nonumber
	&+ \sum_{i=1}^{N-1} \binom{N}{i} (i-Ns)s^{i-1}(1-s)^{N-i-1}\alpha^k_i
\end{align}
\begin{align}
	(\theta^--\theta_0)^2\frac{\partial^2\phi_k}{\partial\theta^2} &= 
	N(N-1)\left[ (1-s)^{N-2}\alpha^k_0 + s^{N-2}\alpha^k_N \right.\\
		&+ ((N-2)s(1-s)^{N-3} - 2(1-s)^{N-2})\alpha^k_1 \nonumber \\
		&+ \left. ((N-2)s^{N-3}(1-s) - 2s^{N-2})\alpha^k_{N-1}	\right] \nonumber \\
	&+ \sum_{i=2}^{N-2} \binom{N}{i} 
		\left(s^{i-2}(1-s)^{N-i-2}(i^2-i(2(N-1)s + 1) + N(N-1)s^2 \right) \alpha^k_i \nonumber
\end{align}

Therefore, we have an explicit and somewhat simple form of the vector functions $\Phi\left(\theta\right)$, $\Phi'\left(\theta\right)$ and $\Phi''\left(\theta\right)$. These may be used in Equation \ref{eqn:zerodyn} to explicitly calculate the zero dynamics at any given $\theta$. This is critical for the numerical integration method discussed in the following section. Note that the performance of the numerical solution can be significantly improved by precalculating the values of $\binom{N}{i}$.